{% extends('mobile/base.html.twig') %}

{% block content %}
    <table>
        <tr class="thead"><th colspan="2">Doorkomststaat</th></tr>
        <tr>
            <td style="width: 110px; text-align: right;"><label for="day_number">Dag:</label></td>
            <td style="height: 20px; text-align: left;">
                <select id="day_number" name="dayNumber">
                    {% for dayNumberSelect in 0..6 %}
                        <option {{ dayNumber == dayNumberSelect ? 'selected="selected" ' }}value="{{ dayNumberSelect }}">{{ ('general.date.days.' ~ dayNumberSelect) | trans }}</option>
                    {% endfor %}
                </select>
            </td>
        </tr><tr>
            <td style="width:110px; text-align:right;"><label for="time_start">Starttijd:</label></td>
            <td style="height:20px; text-align:left;"><input id="time_start" style="width:100px;" type="text" value="{{ startTime }}" /></td>
        </tr><tr>
            <td style="width:110px; text-align:right;"><label for="time_end">Eindtijd:</label></td>
            <td style="height:20px; text-align:left;"><input id="time_end" style="width:100px;" type="text" value="{{ endTime }}" /></td>
        </tr><tr>
            <td style="width:110px; text-align:right;"><label for="location_name">Locatie:</label></td>
            <td style="height:20px; text-align:left;"><input id="location_name" style="width:100px;" type="text" value="{{ locationName }}" /></td>
        </tr><tr>
            <td colspan="2"><a href="#" onclick="searchPassingRoutes(); return false;">Opvragen</a></td>
        </tr>
    </table>

    {% if passingRoutes | length > 0 %}
        <table style="margin-top:5px;">
            <tr class="thead">
                <th colspan="5">{{ locationName | lower | capitalize }} - {{ startTime }} t/m {{ endTime }} ({{ ('general.date.days.' ~ dayNumber) | trans }})</th>
            </tr>
            <tr class="thead">
                <th style="width:60px;">Tijd</th><th>Treinnr</th><th>Actie</th><th>Van</th><th>Naar</th>
            </tr>
            {% for trainTable in passingRoutes %}
                <tr>
                    <td>{{ trainTable['time'] | displayTime }}</td>
                    <td><a href="{{ path('train_table_search', { 'trainTableYearId': trainTableIndexNumber, 'routeNumber': trainTable['route_number'] }) }}">{{ trainTable[constant('App\\Repository\\TrainTable::FIELD_CHARACTERISTIC_NAME')] }}{{ trainTable['route_number'] }}</a></td>
                    <td>{{ trainTable['action'] }}</td>
                    <td><a title="{{ trainTable['fl_first_description'] }}">{{ trainTable['fl_first_name'] }}</a></td>
                    <td><a title="{{ trainTable['fl_last_description'] }}">{{ trainTable['fl_last_name'] }}</a></td>
                </tr>
            {% endfor %}
        </table>
    {% endif %}
{% endblock %}

{% block javascripts %}
    <script>
        function searchPassingRoutes()
        {
            let location = '{{ path('passing_routes_search', { 'trainTableYearId': trainTableIndexNumber, 'locationName': 'locationName', 'dayNumber': 1234, 'startTime': 'startTime', 'endTime': 'endTime' }) }}';
            location = location.replace('locationName', $('#location_name').val());
            location = location.replace('1234', $('#day_number').val());
            location = location.replace('startTime', $('#time_start').val());
            location = location.replace('endTime', $('#time_end').val());
            document.location = location;
        }
    </script>
{% endblock %}
